'use strict';(function(){'use strict';var a=Math.max,b={calendars:[],calendarInputs:[],clockInputs:[],clockHours:{default_:[[gettext_noop('Now'),-1],[gettext_noop('Midnight'),0],[gettext_noop('6 a.m.'),6],[gettext_noop('Noon'),12],[gettext_noop('6 p.m.'),18]]},dismissClockFunc:[],dismissCalendarFunc:[],calendarDivName1:'calendarbox',calendarDivName2:'calendarin',calendarLinkName:'calendarlink',clockDivName:'clockbox',clockLinkName:'clocklink',shortCutsClass:'datetimeshortcuts',timezoneWarningClass:'timezonewarning',timezoneOffset:0,init:function init(){var a=document.getElementsByTagName('body')[0],c=a.getAttribute('data-admin-utc-offset');if(c){var d=-60*new Date().getTimezoneOffset();b.timezoneOffset=d-c}for(var e,f=document.getElementsByTagName('input'),g=0;g<f.length;g++)e=f[g],'text'===e.getAttribute('type')&&e.className.match(/vTimeField/)?(b.addClock(e),b.addTimezoneWarning(e)):'text'===e.getAttribute('type')&&e.className.match(/vDateField/)&&(b.addCalendar(e),b.addTimezoneWarning(e))},now:function now(){var a=document.getElementsByTagName('body')[0],b=a.getAttribute('data-admin-utc-offset');if(b){var c=new Date,d=-60*c.getTimezoneOffset();return c.setTime(c.getTime()+1e3*(b-d)),c}return new Date},addTimezoneWarning:function addTimezoneWarning(a){var c=django.jQuery,d=b.timezoneWarningClass,e=b.timezoneOffset/3600;if(e&&!c(a).siblings('.'+d).length){var f;0<e?f=ngettext('Note: You are %s hour ahead of server time.','Note: You are %s hours ahead of server time.',e):(e*=-1,f=ngettext('Note: You are %s hour behind server time.','Note: You are %s hours behind server time.',e)),f=interpolate(f,[e]);var g=c('<span>');g.attr('class',d),g.text(f),c(a).parent().append(c('<br>')).append(g)}},addClock:function addClock(a){var c=b.clockInputs.length;b.clockInputs[c]=a,b.dismissClockFunc[c]=function(){return b.dismissClock(c),!0};var d=document.createElement('span');d.className=b.shortCutsClass,a.parentNode.insertBefore(d,a.nextSibling);var e=document.createElement('a');e.setAttribute('href','#'),e.appendChild(document.createTextNode(gettext('Now'))),e.addEventListener('click',function(a){a.preventDefault(),b.handleClockQuicklink(c,-1)});var f=document.createElement('a');f.setAttribute('href','#'),f.id=b.clockLinkName+c,f.addEventListener('click',function(a){a.preventDefault(),a.stopPropagation(),b.openClock(c)}),quickElement('span',f,'','class','clock-icon','title',gettext('Choose a Time')),d.appendChild(document.createTextNode('\xA0')),d.appendChild(e),d.appendChild(document.createTextNode('\xA0|\xA0')),d.appendChild(f);var g=document.createElement('div');g.style.display='none',g.style.position='absolute',g.className='clockbox module',g.setAttribute('id',b.clockDivName+c),document.body.appendChild(g),g.addEventListener('click',function(a){a.stopPropagation()}),quickElement('h2',g,gettext('Choose a time'));var h=quickElement('ul',g);h.className='timelist';var i='undefined'==typeof b.clockHours[a.name]?'default_':a.name;b.clockHours[i].forEach(function(a){var d=quickElement('a',quickElement('li',h),gettext(a[0]),'href','#');d.addEventListener('click',function(d){d.preventDefault(),b.handleClockQuicklink(c,a[1])})});var j=quickElement('p',g);j.className='calendar-cancel';var k=quickElement('a',j,gettext('Cancel'),'href','#');k.addEventListener('click',function(a){a.preventDefault(),b.dismissClock(c)}),document.addEventListener('keyup',function(a){27===a.which&&(b.dismissClock(c),a.preventDefault())})},openClock:function openClock(c){var d=document.getElementById(b.clockDivName+c),e=document.getElementById(b.clockLinkName+c);d.style.left='rtl'===getStyle(document.body,'direction')?findPosX(e)-110+'px':findPosX(e)+17+'px',d.style.top=a(0,findPosY(e)-30)+'px',d.style.display='block',document.addEventListener('click',b.dismissClockFunc[c])},dismissClock:function dismissClock(a){document.getElementById(b.clockDivName+a).style.display='none',document.removeEventListener('click',b.dismissClockFunc[a])},handleClockQuicklink:function handleClockQuicklink(a,c){var e;e=-1===c?b.now():new Date(1970,1,1,c,0,0,0),b.clockInputs[a].value=e.strftime(get_format('TIME_INPUT_FORMATS')[0]),b.clockInputs[a].focus(),b.dismissClock(a)},addCalendar:function addCalendar(a){var c=b.calendars.length;b.calendarInputs[c]=a,b.dismissCalendarFunc[c]=function(){return b.dismissCalendar(c),!0};var d=document.createElement('span');d.className=b.shortCutsClass,a.parentNode.insertBefore(d,a.nextSibling);var e=document.createElement('a');e.setAttribute('href','#'),e.appendChild(document.createTextNode(gettext('Today'))),e.addEventListener('click',function(a){a.preventDefault(),b.handleCalendarQuickLink(c,0)});var f=document.createElement('a');f.setAttribute('href','#'),f.id=b.calendarLinkName+c,f.addEventListener('click',function(a){a.preventDefault(),a.stopPropagation(),b.openCalendar(c)}),quickElement('span',f,'','class','date-icon','title',gettext('Choose a Date')),d.appendChild(document.createTextNode('\xA0')),d.appendChild(e),d.appendChild(document.createTextNode('\xA0|\xA0')),d.appendChild(f);var g=document.createElement('div');g.style.display='none',g.style.position='absolute',g.className='calendarbox module',g.setAttribute('id',b.calendarDivName1+c),document.body.appendChild(g),g.addEventListener('click',function(a){a.stopPropagation()});var h=quickElement('div',g),i=quickElement('a',h,'<','href','#');i.className='calendarnav-previous',i.addEventListener('click',function(a){a.preventDefault(),b.drawPrev(c)});var j=quickElement('a',h,'>','href','#');j.className='calendarnav-next',j.addEventListener('click',function(a){a.preventDefault(),b.drawNext(c)});var k=quickElement('div',g,'','id',b.calendarDivName2+c);k.className='calendar',b.calendars[c]=new Calendar(b.calendarDivName2+c,b.handleCalendarCallback(c)),b.calendars[c].drawCurrent();var l=quickElement('div',g);l.className='calendar-shortcuts';var m=quickElement('a',l,gettext('Yesterday'),'href','#');m.addEventListener('click',function(a){a.preventDefault(),b.handleCalendarQuickLink(c,-1)}),l.appendChild(document.createTextNode('\xA0|\xA0')),m=quickElement('a',l,gettext('Today'),'href','#'),m.addEventListener('click',function(a){a.preventDefault(),b.handleCalendarQuickLink(c,0)}),l.appendChild(document.createTextNode('\xA0|\xA0')),m=quickElement('a',l,gettext('Tomorrow'),'href','#'),m.addEventListener('click',function(a){a.preventDefault(),b.handleCalendarQuickLink(c,1)});var n=quickElement('p',g);n.className='calendar-cancel';var o=quickElement('a',n,gettext('Cancel'),'href','#');o.addEventListener('click',function(a){a.preventDefault(),b.dismissCalendar(c)}),django.jQuery(document).bind('keyup',function(a){27===a.which&&(b.dismissCalendar(c),a.preventDefault())})},openCalendar:function openCalendar(c){var d=document.getElementById(b.calendarDivName1+c),e=document.getElementById(b.calendarLinkName+c),f=b.calendarInputs[c];if(f.value){var g=get_format('DATE_INPUT_FORMATS')[0],h=f.value.strptime(g),i=h.getUTCFullYear(),j=h.getUTCMonth()+1,k=/\d{4}/;k.test(i.toString())&&1<=j&&12>=j&&b.calendars[c].drawDate(j,i,h)}d.style.left='rtl'===getStyle(document.body,'direction')?findPosX(e)-180+'px':findPosX(e)+17+'px',d.style.top=a(0,findPosY(e)-75)+'px',d.style.display='block',document.addEventListener('click',b.dismissCalendarFunc[c])},dismissCalendar:function dismissCalendar(a){document.getElementById(b.calendarDivName1+a).style.display='none',document.removeEventListener('click',b.dismissCalendarFunc[a])},drawPrev:function drawPrev(a){b.calendars[a].drawPreviousMonth()},drawNext:function drawNext(a){b.calendars[a].drawNextMonth()},handleCalendarCallback:function handleCalendarCallback(a){var c=get_format('DATE_INPUT_FORMATS')[0];return c=c.replace('\\','\\\\'),c=c.replace('\r','\\r'),c=c.replace('\n','\\n'),c=c.replace('\t','\\t'),c=c.replace('\'','\\\''),function(e,f,g){b.calendarInputs[a].value=new Date(e,f-1,g).strftime(c),b.calendarInputs[a].focus(),document.getElementById(b.calendarDivName1+a).style.display='none'}},handleCalendarQuickLink:function handleCalendarQuickLink(a,c){var e=b.now();e.setDate(e.getDate()+c),b.calendarInputs[a].value=e.strftime(get_format('DATE_INPUT_FORMATS')[0]),b.calendarInputs[a].focus(),b.dismissCalendar(a)}};window.addEventListener('load',b.init),window.DateTimeShortcuts=b})();

//# sourceMappingURL=DateTimeShortcuts-compiled.js.map